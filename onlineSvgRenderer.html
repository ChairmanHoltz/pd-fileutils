<!DOCTYPE html>
<html>
<head>

  <title>Online SVG renderer - [pd-fileutils] demo</title>
  <meta charset="utf-8">

  <script src="js/jquery.min.js"></script>
  <script src="js/d3.v3.min.js"></script>
  <script src="js/underscore-min.js"></script>
  <script src="js/mustache.js"></script>
  <script>var mustache = Mustache</script>
  <script src="https://raw.github.com/sebpiq/pd-fileutils/master/dist/pd-fileutils-latest.js"></script>
  <link href="css/reset.css" rel="stylesheet" />
  <link href='http://fonts.googleapis.com/css?family=Paytone+One' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Tauri' rel='stylesheet' type='text/css'>
  <link rel="stylesheet/less" type="text/css" href="css/common.less" />
  <link rel="stylesheet/less" type="text/css" href="css/onlineSvgRenderer.less" />
  <script src="js/less-1.3.3.min.js" type="text/javascript"></script>


</head>

<body>

  <div id="instructions">
    <ol>
      <li>Create a patch</li>
      <li>Post it to <a href="https://gist.github.com/">gist.github.com</a></li>
      <li>type in your gist id in the field below and press "render"</li>
      <form id="renderGistForm">
        <input type="text" name="gistId" placeholder="gist id"/>
        <input type="submit" value="render"/>
      </form>
    </ol>
  </div>

  <div id="svg">
    <div id="loading">loading ...</div>
  </div>

  <div id="nav">

    <ul>
      <li>JSON format</li>
      <li>Pd format</li>
      <li>about</li>
    </ul>

    <div id="social">
      <div id="github">
        <iframe src="http://ghbtns.com/github-btn.html?user=sebpiq&repo=pd-fileutils&type=watch&count=true&size=large"
          allowtransparency="true" frameborder="0" scrolling="0" width="120" height="30"></iframe>
      </div>
    </div>

  </div>

  <div id="tabs">

    <div id="json" class="tab">
      <div class="innerTab">
        <pre><code data-language="javascript"></code></pre>
      </div>
    </div>

    <div id="pd" class="tab">
      <div class="innerTab">
        <pre><code></code></pre>
      </div>
    </div>

    <div id="about" class="tab">
      <div class="innerTab">
        <p>This is a SVG patch renderer. Post your patch to gist, then display it here.</p>
        <p>This is a demo of the <a href="https://github.com/sebpiq/pd-fileutils">pd-fileutils</a> library</p>
        <p id="copyright">
        pd-fileutils - Copyright (c) 2013 SÃ©bastien Piquemal <a href="mailto:sebpiq@gmail.com">&lt;sebpiq@gmail.com&gt;</a>. Complete license <a href="https://github.com/sebpiq/pd-fileutils/blob/master/LICENSE.txt">here</a>
        </p>
      </div>
    </div>

  </div>


  <script>
    // Loadding gist
    var gistParamRe = /gist=(\w*)/
      , searchResult
      , gistLoaded = function(resp) {
        var files = resp.data.files
          , content = files[Object.keys(files)[0]].content
          , patch = pdfu.parse(content)
          , patchSvg = pdfu.renderSvg(patch, {svgFile: false})
        $('#svg').html(patchSvg)
        $('#json code').html(JSON.stringify(patch, null, 4))
        $('#pd code').html(content)
        $('#loading').hide()
      }

    if (searchResult = gistParamRe.exec(window.location.search)) {
      var gistUrl = 'https://api.github.com/gists/'
        + searchResult[1] + '?callback=gistLoaded'
      $('<script>', {src: gistUrl}).appendTo('body')
      $('#svg').show()
    } else $('#instructions').show()

    $('#renderGistForm').submit(function(event) {
      event.preventDefault()
      window.location.replace(window.location.pathname + '?gist=' + $(this).find('input[name=gistId]').val())
    })

    // Setup tabs
    $('#nav li').each(function(i, li) {
      $(li).click(function() {
        $('#tabs .tab').removeClass('active')
        $('#tabs .tab').slice(i, i+1).addClass('active')
      })
    })
    $('#tabs .tab').each(function(i, tab) {
      $('<a>', {'class': 'closeTab'}).html('X').appendTo(tab).click(function() {
        $(tab).removeClass('active')
      })
    })

  </script>

  <script src="https://raw.github.com/ccampbell/rainbow/master/js/rainbow.min.js"></script>
  <script src="https://raw.github.com/ccampbell/rainbow/master/js/language/generic.js"></script>
  <script src="https://raw.github.com/ccampbell/rainbow/master/js/language/javascript.js"></script>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-17637518-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</body>

</html>
